/* ======= Override patch: place at END of CSS ======= */

/* Ensure single authoritative variables (avoid duplicates causing confusion) */
:root {
  --gm-max-w: 1400px;
  --gm-sidebar-width-sm: 280px;
  --gm-sidebar-width-lg: 320px;
  --gm-overlay-z: 50;
  --gm-sidebar-z: 60;
}

/* Mobile overlay: hidden by default and non-blocking when hidden */
.mobile-overlay {
  position: fixed;
  inset: 0;
  display: none;
  background: rgba(0,0,0,0.28);
  z-index: var(--gm-overlay-z);
  pointer-events: none; /* don't block clicks when hidden */
}

/* visible overlay state */
.mobile-overlay.show {
  display: block;
  pointer-events: auto;  /* block clicks only when shown */
}

/* Make sure interactive elements accept pointer events */
button, a, input, select, textarea, .nav-link, .card, .section {
  -webkit-tap-highlight-color: rgba(0,0,0,0.06);
  pointer-events: auto !important;
}

/* Final authoritative sidebar rules (mobile-first) */
.sidebar {
  display: none; /* hidden by default on small screens; we will toggle with JS */
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: var(--gm-sidebar-width-sm);
  background: #fff;
  z-index: var(--gm-sidebar-z);
  transform: translateX(-115%);
  transition: transform .28s ease, visibility .28s ease;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  box-shadow: 2px 0 18px rgba(0,0,0,0.08);
  pointer-events: auto;
}

/* open state for sidebar */
.sidebar.open {
  transform: translateX(0);
  display: block;
}

/* Desktop/tablet: show sidebar inline and avoid fixed stacking issues */
@media (min-width: 700px) {
  .sidebar {
    display: block !important;
    position: relative !important;    /* avoid overlapping content */
    transform: none !important;
    width: var(--gm-sidebar-width-lg);
    box-shadow: none !important;
    z-index: auto;
  }
  /* ensure overlay never shows on larger viewports */
  .mobile-overlay { display: none !important; pointer-events: none !important; }
}

/* Ensure header doesn't overlap content (if fixed anywhere earlier) */
.header, .app-header {
  position: relative !important;
  z-index: auto !important;
}

/* If any element used full-screen fixed positioning accidentally, make it non-intercepting by default.
   Only elements explicitly given .blocker or .mobile-overlay.show should block interactions. */
[style*="position:fixed"]:not(.mobile-overlay):not(.modal):not(.sidebar) {
  /* keep them interactive but do not block entire page unless explicitly intended */
  pointer-events: auto;
}

/* Debug utility (temporary) - show big invisible hitboxes to find blockers if needed */
.debug-hitbox {
  outline: 2px dashed rgba(255,0,0,0.65);
  background: rgba(255,0,0,0.03);
}
